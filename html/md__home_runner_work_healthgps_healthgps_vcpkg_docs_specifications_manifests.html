<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Health-GPS: Manifests &ndash; &lt;tt&gt;vcpkg.json&lt;/tt&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Health-GPS
   &#160;<span id="projectnumber">1.2.2.0</span>
   </div>
   <div id="projectbrief">Global Health Policy Simulation model (Health-GPS)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__home_runner_work_healthgps_healthgps_vcpkg_docs_specifications_manifests.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Manifests &ndash; <code>vcpkg.json</code> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Note: this is the feature as it was initially specified and does not necessarily reflect the current behavior.</b></p>
<p><b>Up-to-date documentation is available at <a class="el" href="md__home_runner_work_healthgps_healthgps_vcpkg_docs_users_manifests.html">Manifests</a>.</b></p>
<p>For many other language package managers, there exists a way of writing one's dependencies in a declarative manifest format; we want something similar for vcpkg. What follows is the specification of that feature; this should mean that vcpkg becomes far more user and enterprise-friendly, and is additionally an important first step for versioning and package federation. Our primary concern, beyond implementability, is ease-of-use; it is important that using this feature is all of:</p>
<ul>
<li>Easy for existing users</li>
<li>Easy for new users to set up</li>
<li>Easy to extend later for new features like versioning and federation</li>
<li><em>Declarative</em>, not <em>Imperative</em>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md3800"></a>
Reasoning</h1>
<h2><a class="anchor" id="autotoc_md3801"></a>
Why JSON?</h2>
<p>We choose JSON for five main reasons:</p>
<ul>
<li>Everybody knows JSON, and if one doesn't, it's really easy to learn</li>
<li>Every tool supports JSON in the standard library, or in a commonly used support library<ul>
<li>This means writing tooling should be trivial in any language one is comfortable with</li>
<li>Most configuration formats don't have a COBOL implementation üòâ</li>
</ul>
</li>
<li>Specified in an international standard<ul>
<li>There is <em>one</em> right way to parse JSON</li>
<li>There are no ambiguities of what the parse tree <em>should</em> be</li>
</ul>
</li>
<li>Simple and secure<ul>
<li>Unlike YAML, for example, there's no weird ACE issues</li>
<li>Easy to write a parser &ndash; important since we can't depend on external libraries</li>
</ul>
</li>
<li>Schemas are almost a necessity</li>
</ul>
<p>Some have suggested allowing comments or commas in our parser; we chose to use JSON proper rather than JSON5 or JSON with comments because JSON is the everywhere-supported international standard. That is not necessarily true of JSON with comments. Additionally, if one needs to write a comment, they can do so via <code>"$reason"</code> or <code>"$comment"</code> fields.</p>
<h1><a class="anchor" id="autotoc_md3802"></a>
Specification</h1>
<p>A manifest file shall have the name <code>vcpkg.json</code>, and shall be in the root directory of a package. It also replaces CONTROL files, though existing CONTROL files will still be supported; there will be no difference between ports and packages, except that packages do not need to supply portfile.cmake (eventually we would like to remove the requirement of portfile.cmake for ports that already use CMake).</p>
<p>The specification uses definitions from the <a href="#definitions">Definitions</a> section in order to specify the shape of a value. Note that any object may contain any directives, written as a field key that starts with a <code>$</code>; these directives shall be ignored by <code>vcpkg</code>. Common directives may include <code>"$schema"</code>, <code>"$comment"</code>, <code>"$reason"</code>.</p>
<p>A manifest must be a top-level object, and must have at least:</p>
<ul>
<li><code>"name"</code>: a <code>&lt;package-name&gt;</code></li>
<li>One (and only one) of the following version fields:<ul>
<li><code>"version-string"</code>: A <code>string</code>. Has no semantic meaning. Equivalent to <code>CONTROL</code>'s <code>Version:</code> field.</li>
<li>Other version fields will be defined by the Versions RFC</li>
</ul>
</li>
</ul>
<p>The simplest vcpkg.json looks like this:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;name&quot;: &quot;mypackage&quot;,</div>
<div class="line">  &quot;version-string&quot;: &quot;0.1.0-dev&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Additionally, it may contain the following properties:</p><ul>
<li><code>"port-version"</code>: A non-negative integer. If this field doesn't exist, it's assumed to be <code>0</code>.<ul>
<li>Note that this is a change from existing CONTROL files, where versions were a part of the version string</li>
</ul>
</li>
<li><code>"maintainers"</code>: An array of <code>string</code>s which contain the authors of a package<ul>
<li><code>"maintainers": [ "Nicole Mazzuca &lt;nicole@example.com&gt;", "◊©◊ú◊ï◊ù ◊¢◊ú◊ô◊õ◊ù &lt;shalom@example.com&gt;" ]</code></li>
</ul>
</li>
<li><code>"description"</code>: A string or array of strings containing the description of a package<ul>
<li><code>"description": "mypackage is a package of mine"</code></li>
</ul>
</li>
<li><code>"homepage"</code>: A url which points to the homepage of a package<ul>
<li><code>"homepage": "https://github.com/strega-nil/mypackage"</code></li>
</ul>
</li>
<li><code>"documentation"</code>: A url which points to the documentation of a package<ul>
<li><code>"documentation": "https://readthedocs.io/strega-nil/mypackage"</code></li>
</ul>
</li>
<li><code>"license"</code>: A <code>&lt;license-string&gt;</code><ul>
<li><code>"license": "MIT"</code></li>
</ul>
</li>
<li><code>"dependencies"</code>: An array of <code>&lt;dependency&gt;</code>s</li>
<li><code>"dev-dependencies"</code>: An array of <code>&lt;dependency&gt;</code>s which are required only for developers (testing and the like)</li>
<li><code>"features"</code>: An array of <code>&lt;feature&gt;</code>s that the package supports</li>
<li><code>"default-features"</code>: An array of <code>&lt;identifier&gt;</code>s that correspond to features, which will be used by default.</li>
<li><code>"supports"</code>: A <code>&lt;platform-expression&gt;</code><ul>
<li><code>"supports": "windows &amp; !arm"</code></li>
</ul>
</li>
</ul>
<p>Any properties which are not listed, and which do not start with a <code>$</code>, will be warned against and are reserved for future use.</p>
<p>The following is an example of an existing port CONTROL file rewritten as a vcpkg.json file:</p>
<div class="fragment"><div class="line">Source: pango</div>
<div class="line">Version: 1.40.11-6</div>
<div class="line">Homepage: https://ftp.gnome.org/pub/GNOME/sources/pango/</div>
<div class="line">Description: Text and font handling library.</div>
<div class="line">Build-Depends: glib, gettext, cairo, fontconfig, freetype, harfbuzz[glib] (!(windows&amp;static)&amp;!osx)</div>
</div><!-- fragment --><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;name&quot;: &quot;pango&quot;,</div>
<div class="line">  &quot;version-string&quot;: &quot;1.40.11&quot;,</div>
<div class="line">  &quot;port-version&quot;: 6,</div>
<div class="line">  &quot;homepage&quot;: &quot;https://ftp.gnome.org/pub/GNOME/sources/pango/&quot;,</div>
<div class="line">  &quot;description&quot;: &quot;Text and font handling library.&quot;,</div>
<div class="line">  &quot;dependencies&quot;: [</div>
<div class="line">    &quot;glib&quot;,</div>
<div class="line">    &quot;gettext&quot;,</div>
<div class="line">    &quot;cairo&quot;,</div>
<div class="line">    &quot;fontconfig&quot;,</div>
<div class="line">    &quot;freetype&quot;,</div>
<div class="line">    {</div>
<div class="line">      &quot;name&quot;: &quot;harfbuzz&quot;,</div>
<div class="line">      &quot;features&quot;: [ &quot;glib&quot; ],</div>
<div class="line">      &quot;platform&quot;: &quot;!(windows &amp; static) &amp; !osx&quot;</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3803"></a>
Behavior of the Tool</h1>
<p>There will be two "modes" for vcpkg from this point forward: "classic", and "manifest". The former will act exactly like the existing vcpkg workflow, so as to avoid breaking anyone. The latter will be the mode only when the user either:</p>
<ul>
<li>Passes <code>--manifest-root=&lt;directory&gt;</code> (initially, <code>x-manifest-root</code>)</li>
<li>Runs <code>vcpkg</code> in a directory that contains a file named <code>vcpkg.json</code>, or in a child directory of a directory containing <code>vcpkg.json</code>.<ul>
<li>For this, initially vcpkg will warn that the behavior will change in the future, and simply run in classic mode, unless the feature flag <code>manifests</code> is passed via:<ul>
<li>The environment variable <code>VCPKG_FEATURE_FLAGS</code></li>
<li>The option <code>--feature-flags</code><ul>
<li>(e.g., <code>--feature-flags=binarycaching,manifests</code>)</li>
</ul>
</li>
<li>If someone wants to use classic mode and silence the warning, they can add the <code>-manifests</code> feature flag to disable the mode.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>When in "manifest" mode, the <code>installed</code> directory will be changed to <code>&lt;manifest-root&gt;/vcpkg_installed</code> (name up for bikeshedding). The following commands will change behavior:</p>
<ul>
<li><code>vcpkg install</code> without any port arguments will install the dependencies listed in the manifest file, and will remove any dependencies which are no longer in the dependency tree implied by the manifest file.</li>
<li><code>vcpkg install</code> with port arguments will give an error.</li>
</ul>
<p>The following commands will not work in manifest mode, at least initially:</p>
<ul>
<li><code>vcpkg x-set-installed</code>: <code>vcpkg install</code> serves the same function</li>
<li><code>vcpkg remove</code></li>
<li><code>vcpkg export</code></li>
</ul>
<p>We may add these features back for manifest mode once we understand how best to implement them.</p>
<h2><a class="anchor" id="autotoc_md3804"></a>
Behavior of the Toolchain</h2>
<p>Mostly, the toolchain file stays the same; however, we shall add two public options:</p>
<div class="fragment"><div class="line">VCPKG_MANIFEST_MODE:BOOL=&lt;we found a manifest&gt;</div>
<div class="line">VCPKG_MANIFEST_INSTALL:BOOL=ON</div>
</div><!-- fragment --><p>The first option either explicitly turns on, or off, manifest mode; otherwise, we default to looking for a manifest file in the directory tree upwards from the source directory.</p>
<p>The <code>VCPKG_MANIFEST_INSTALL</code> option tells the toolchain whether to install the packages or not &ndash; if you wish to install the manifest dependencies manually, you can set this to off, and we also turn it off for packages installed by vcpkg.</p>
<p>Additionally, if <code>-manifests</code> is set in the feature flags environment variable, we turn off manifest mode in the toolchain, and we act like the classic toolchain.</p>
<h2><a class="anchor" id="autotoc_md3805"></a>
Example - CMake Integration</h2>
<p>An example of using the new vcpkg manifests feature for a new project follows:</p>
<p>The filesystem structure should look something like:</p>
<div class="fragment"><div class="line">example/</div>
<div class="line">  src/</div>
<div class="line">    main.cxx</div>
<div class="line">  CMakeLists.txt</div>
<div class="line">  vcpkg.json</div>
</div><!-- fragment --><p>Then, <code>main.cxx</code> might look like:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;fmt/format.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="out_2build_2linux-debug_2vcpkg__installed_2x64-linux_2src_2gtest__main_8cc.html#a7f83bdc516d2cb86e20235d94ddf055a">main</a>() {</div>
<div class="line">  <a class="code" href="out_2build_2linux-debug_2vcpkg__installed_2x64-linux_2include_2fmt_2color_8h.html#a2fead8330d19b9d2f10e6ed9c59e0174">fmt::print</a>(<span class="stringliteral">&quot;Hello, {}!&quot;</span>, <span class="stringliteral">&quot;world&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aout_2build_2linux-debug_2vcpkg__installed_2x64-linux_2include_2fmt_2color_8h_html_a2fead8330d19b9d2f10e6ed9c59e0174"><div class="ttname"><a href="out_2build_2linux-debug_2vcpkg__installed_2x64-linux_2include_2fmt_2color_8h.html#a2fead8330d19b9d2f10e6ed9c59e0174">print</a></div><div class="ttdeci">void print(std::FILE *f, const text_style &amp;ts, const S &amp;format_str, const Args &amp;... args)</div><div class="ttdef"><b>Definition:</b> color.h:508</div></div>
<div class="ttc" id="aout_2build_2linux-debug_2vcpkg__installed_2x64-linux_2src_2gtest__main_8cc_html_a7f83bdc516d2cb86e20235d94ddf055a"><div class="ttname"><a href="out_2build_2linux-debug_2vcpkg__installed_2x64-linux_2src_2gtest__main_8cc.html#a7f83bdc516d2cb86e20235d94ddf055a">main</a></div><div class="ttdeci">GTEST_API_ int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> gtest_main.cc:48</div></div>
</div><!-- fragment --><p>Therefore, in <code>vcpkg.json</code>, we'll need to depend on <code>fmt</code>:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;name&quot;: &quot;example&quot;,</div>
<div class="line">  &quot;version-string&quot;: &quot;0.0.1&quot;,</div>
<div class="line">  &quot;dependencies&quot;: [</div>
<div class="line">    &quot;fmt&quot;</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Then, let's write our <code>CMakeLists.txt</code>:</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line"> </div>
<div class="line">project(example CXX)</div>
<div class="line"> </div>
<div class="line">add_executable(example src/main.cxx)</div>
<div class="line"> </div>
<div class="line">find_package(fmt REQUIRED)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(example</div>
<div class="line">  PRIVATE</div>
<div class="line">    fmt::fmt)</div>
</div><!-- fragment --><p>And finally, to configure and build:</p>
<div class="fragment"><div class="line">$ cd example</div>
<div class="line">$ cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=$VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake</div>
<div class="line">... configuring and installing...</div>
<div class="line">$ cmake --build build</div>
</div><!-- fragment --><p>and we're done! <code>fmt</code> will get installed into <code>example/build/vcpkg_installed</code>, and we can run our executable with:</p>
<div class="fragment"><div class="line">$ build/example</div>
<div class="line">Hello, world!</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3806"></a>
Definitions</h1>
<ul>
<li><code>&lt;identifier&gt;</code>: A <code>string</code> which:<ul>
<li>Is entirely ASCII</li>
<li>Contains only lowercase alphabetic characters, digits, and hyphen-minus</li>
<li>Does not have multiple consecutive hyphens</li>
<li>Does not begin nor end with a hyphen</li>
<li>Is not a Windows filesystem reserved name</li>
<li>Is not a vcpkg reserved name: "default" or "core".</li>
<li>In other words, it must follow the regex <code>[a-z0-9]+(-[a-z0-9]+)*</code>, and must not be any of:<ul>
<li><code>{ prn, aux, nul, con, lpt[1-9], com[1-9], core, default }</code></li>
</ul>
</li>
</ul>
</li>
<li><code>&lt;package-name&gt;</code>: A <code>string</code> consisting of a non-zero number of <code>&lt;identifier&gt;</code>s, separated by <code>.</code>.<ul>
<li><code>a.b.c</code> is valid</li>
<li><code>a</code> is valid</li>
<li><code>a/b</code> is not valid</li>
<li><code>Boost.Beast</code> is not valid, but <code>boost.beast</code> is</li>
</ul>
</li>
<li><code>&lt;dependency&gt;</code>: Either a <code>&lt;package-name&gt;</code>, or an object:<ul>
<li>A dependency always contains the following:<ul>
<li><code>"name"</code>: A <code>&lt;package-name&gt;</code></li>
<li>Optionally, <code>"features"</code>: an array of <code>&lt;identifier&gt;</code>s corresponding to features in the package.</li>
<li>Optionally, <code>"default-features"</code>: a <code>boolean</code>. If this is false, then don't use the default features of the package; equivalent to core in existing CONTROL files. If this is true, do the default thing of including the default features.</li>
<li>Optionally, <code>"platform"</code>: a <code>&lt;platform-expression&gt;</code></li>
</ul>
</li>
<li><code>&lt;dependency.port&gt;</code>: No extra fields are required.</li>
</ul>
</li>
<li><code>&lt;license-string&gt;</code>: An SPDX license expression at version 3.9.</li>
<li><code>&lt;platform-expression&gt;</code>: A specification of a set of platforms; used in platform-specific dependencies and supports fields. A string that is parsed as follows:<ul>
<li><code>&lt;platform-expression&gt;</code>:<ul>
<li><code>&lt;platform-expression.not&gt;</code></li>
<li><code>&lt;platform-expression.and&gt;</code></li>
<li><code>&lt;platform-expression.or&gt;</code></li>
</ul>
</li>
<li><code>&lt;platform-expression.simple&gt;</code>:<ul>
<li><code>( &lt;platform-expression&gt; )</code></li>
<li><code>&lt;platform-expression.identifier&gt;</code></li>
</ul>
</li>
<li><code>&lt;platform-expression.identifier&gt;</code>:<ul>
<li>regex: <code>/^[a-z0-9]+$/</code></li>
</ul>
</li>
<li><code>&lt;platform-expression.not&gt;</code>:<ul>
<li><code>&lt;platform-expression.simple&gt;</code></li>
<li><code>! &lt;platform-expression.simple&gt;</code></li>
</ul>
</li>
<li><code>&lt;platform-expression.and&gt;</code><ul>
<li><code>&lt;platform-expression.not&gt;</code></li>
<li><code>&lt;platform-expression.and&gt; &amp; &lt;platform-expression.not&gt;</code></li>
</ul>
</li>
<li><code>&lt;platform-expression.or&gt;</code><ul>
<li><code>&lt;platform-expression.not&gt;</code></li>
<li><code>&lt;platform-expression.or&gt; | &lt;platform-expression.not&gt;</code></li>
</ul>
</li>
</ul>
</li>
<li><code>&lt;feature&gt;</code>: An object containing the following:<ul>
<li><code>"name"</code>: An <code>&lt;identifier&gt;</code>, the name of the feature</li>
<li><code>"description"</code>: A <code>string</code> or array of <code>string</code>s, the description of the feature</li>
<li>Optionally, <code>"dependencies"</code>: An array of <code>&lt;dependency&gt;</code>s, the dependencies used by this feature </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
